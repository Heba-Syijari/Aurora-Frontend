import { Box, Stack, Typography } from '@mui/material';
import Lottie from 'lottie-react';
import { BaseButton } from 'src/components/styled/button';

import { useEffect } from 'react';
import loaderAnimation from '../../assets/lotti/logo.json';

type FinishSectionProps = {
  onBackClicked: () => void;
  onStartGenerateClicked: () => void;
  loading?: boolean;
};

export default function FinishSection({
  onBackClicked,
  onStartGenerateClicked,
  loading,
}: FinishSectionProps) {
  useEffect(() => {
    window.scrollTo({
      top: 0,
      left: 0,
      behavior: 'smooth',
    });
  }, []);

  const renderLoading = (
    <>
      <Box width={200}>
        <Lottie animationData={loaderAnimation} loop />
      </Box>
      <Box sx={{ mt: 1, textAlign: 'center' }}>
        <Typography variant="subtitle1">
          Your request is being processed, It might take some time.
        </Typography>
        <Typography variant="caption" color="text.secondary">
          But still faster than Windows update.
        </Typography>
      </Box>
    </>
  );

  const renderWeAreAlmostDone = (
    <>
      <Box
        component="svg"
        width="80px"
        height="80px"
        viewBox="0 0 80 80"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          opacity="0.4"
          d="M70.8701 43.6649C72.6101 43.1949 73.4802 42.9615 73.8236 42.5115C74.1669 42.0648 74.1667 41.3415 74.1667 39.8982V33.4548C74.1667 32.0115 74.1669 31.2882 73.8236 30.8415C73.4802 30.3915 72.6101 30.1582 70.8701 29.6882C64.3701 27.9349 60.3002 21.1381 61.9769 14.6781C62.4402 12.9015 62.6702 12.0149 62.4502 11.4949C62.2302 10.9715 61.5967 10.6149 60.3333 9.89492L54.5833 6.63157C53.3433 5.92824 52.7233 5.57484 52.1667 5.64817C51.61 5.72484 50.98 6.35155 49.7233 7.60488C44.86 12.4582 36.8133 12.4582 31.9466 7.60488C30.69 6.35155 30.0635 5.72484 29.5068 5.64817C28.9502 5.57484 28.3302 5.92824 27.0902 6.63157L21.3402 9.89492C20.0768 10.6116 19.4433 10.9716 19.2233 11.4916C19.0033 12.0149 19.2334 12.9015 19.6934 14.6781C21.37 21.1381 17.3002 27.9349 10.7969 29.6882C9.05688 30.1582 8.18676 30.3915 7.84342 30.8415C7.50009 31.2882 7.5 32.0115 7.5 33.4548V39.8982C7.5 41.3415 7.50009 42.0648 7.84342 42.5115C8.18676 42.9615 9.05688 43.1949 10.7969 43.6649C17.2969 45.4183 21.3668 52.2148 19.6901 58.6714C19.2268 60.4481 18.9968 61.3381 19.2168 61.8581C19.4368 62.3781 20.07 62.7381 21.3333 63.4548L27.0833 66.7216C28.3233 67.4249 28.9433 67.7782 29.5 67.7016C30.0567 67.6282 30.6867 67.0016 31.9434 65.7483C34.7867 62.9083 38.7169 61.7316 42.4635 62.2082C41.4202 60.0282 40.8333 57.5882 40.8333 55.0082C40.8333 52.6049 41.3435 50.3214 42.2568 48.2548C41.7902 48.3114 41.3167 48.3415 40.8333 48.3415C34.39 48.3415 29.1667 43.1182 29.1667 36.6749C29.1667 30.2315 34.39 25.0082 40.8333 25.0082C47.2767 25.0082 52.5 30.2315 52.5 36.6749C52.5 37.5415 52.4069 38.3816 52.2269 39.1949C53.8836 38.6416 55.6567 38.3415 57.5 38.3415C62.46 38.3415 66.9135 40.5082 69.9668 43.9449C70.2601 43.8416 70.5635 43.7483 70.8701 43.6649Z"
          fill="#4E92FF"
        />
        <path
          d="M26.1596 68.0166C27.36 68.696 28.2714 69.2118 29.3932 69.2118L29.3968 69.2051C29.5601 69.2051 29.7267 69.1951 29.9001 69.1717C31.1067 69.0084 31.9899 68.1617 33.4499 66.7617C33.7832 66.4384 34.1335 66.1018 34.4801 65.7884C35.5001 64.8618 35.5768 63.2785 34.6468 62.2585C33.7201 61.2385 32.1365 61.1618 31.1165 62.0918C30.7399 62.4385 30.3566 62.8018 29.9899 63.1551C29.7399 63.3951 29.4232 63.6984 29.1432 63.9551C29.0201 63.8864 28.8903 63.8127 28.7621 63.74L28.6068 63.6519L22.0667 59.9652L21.9567 59.9086L21.7467 59.7985C21.8067 59.4752 21.9102 59.0385 22.0768 58.4751L22.0999 58.3885C24.1399 50.5385 19.3566 42.4652 11.4333 40.3952C10.9233 40.2585 10.4 40.1152 10.0133 39.9986C10.0067 39.7152 10.0065 39.3719 10.0065 39.0485V32.6385C10.0065 32.3185 10.0067 31.9718 10.0133 31.6885C10.3391 31.5883 10.7603 31.4741 11.1972 31.3556L11.4567 31.2852C19.3434 29.1585 24.1267 21.1484 22.1234 13.4284C21.9834 12.8884 21.8433 12.3352 21.75 11.9252C21.9225 11.823 22.1212 11.7101 22.3167 11.599L22.5866 11.4452L28.3532 8.16848L28.5298 8.06896C28.7426 7.94891 28.9592 7.82673 29.1468 7.72512C29.3725 7.93524 29.6506 8.21205 29.9405 8.50045L30.1901 8.74856C36.0634 14.6086 45.6234 14.6085 51.4967 8.75181L51.5045 8.74408C51.8622 8.38633 52.2455 8.00308 52.5433 7.72512C52.7933 7.86179 53.0934 8.03183 53.3568 8.18183L59.1068 11.4452C59.3901 11.6052 59.6934 11.7785 59.9401 11.9252C59.8434 12.3452 59.7001 12.9052 59.5635 13.4252C57.5535 21.1652 62.3366 29.1951 70.2233 31.3218L70.4403 31.3813C70.8564 31.4952 71.3013 31.6171 71.6468 31.7219C71.6699 32.2303 71.6699 32.9022 71.6699 33.3748V33.3885C71.6699 34.7685 72.7899 35.8885 74.1699 35.8885C75.5499 35.8885 76.6699 34.7685 76.6699 33.3885C76.6699 31.2294 76.6699 29.6648 75.8135 28.5518C74.9501 27.4218 73.6601 27.0718 71.5234 26.4951C66.2701 25.0785 63.0735 19.7784 64.3968 14.6851L64.3981 14.68C64.984 12.4332 65.3062 11.1975 64.7533 9.89179C64.1999 8.58845 63.0967 7.96174 61.5667 7.09508L55.7975 3.82236C54.3058 2.97563 53.2262 2.36279 51.8232 2.54853C50.4366 2.73853 49.5534 3.61844 47.9567 5.21178C44.0967 9.06178 37.5733 9.05851 33.6966 5.19517L33.6891 5.1877C32.1005 3.60243 31.2245 2.72824 29.8467 2.54853C28.4545 2.35868 27.3783 2.96748 25.8835 3.81308L25.8799 3.81513L20.1068 7.09508C18.5768 7.95841 17.4733 8.58512 16.9199 9.89179C16.3699 11.1918 16.6901 12.4318 17.2734 14.6818C18.5901 19.7585 15.3934 25.0418 10.1234 26.4618C7.92337 27.0551 6.71336 27.3819 5.86003 28.4986C5.00003 29.6186 5 30.8851 5 32.6351V39.0451C5 40.7951 5.0001 42.0618 5.85677 43.1752C6.7124 44.2971 7.92377 44.6243 10.1154 45.2163L10.1234 45.2185L10.1667 45.2285C15.41 46.5985 18.5899 51.9117 17.2666 57.0884C16.8633 58.4551 16.6566 59.6184 16.6566 60.5451C16.6566 62.0584 17.6668 63.3418 19.6602 64.3518L25.9434 67.8918L26.1335 68.0018L26.1596 68.0166Z"
          fill="#4E92FF"
        />
        <path
          d="M53.6002 61.1455C54.0235 61.9922 54.8935 62.5254 55.8369 62.5254L55.8336 62.5289H55.8935C56.8602 62.5055 57.7304 61.9222 58.1204 61.0355C59.3737 58.1922 62.357 53.3321 65.027 52.3855C66.3303 51.9255 67.0104 50.4955 66.5504 49.1955C66.0904 47.8922 64.6636 47.2121 63.3603 47.6721C59.8936 48.8987 57.1037 52.6289 55.387 55.4989C53.5937 53.9756 51.8102 53.4255 51.5169 53.3422C50.1902 52.9655 48.807 53.7388 48.4303 55.0655C48.0536 56.3921 48.8269 57.7756 50.1536 58.1522C50.1769 58.1589 52.4769 58.8989 53.6002 61.1455Z"
          fill="#4E92FF"
        />
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M57.5033 74.1787C46.9333 74.1787 38.3366 65.582 38.3366 55.012C38.3366 44.442 46.9333 35.8454 57.5033 35.8454C68.0733 35.8454 76.6699 44.442 76.6699 55.012C76.6699 65.582 68.0733 74.1787 57.5033 74.1787ZM57.5033 40.8454C49.6933 40.8454 43.3366 47.202 43.3366 55.012C43.3366 62.822 49.6933 69.1787 57.5033 69.1787C65.3133 69.1787 71.6699 62.822 71.6699 55.012C71.6699 47.202 65.3133 40.8454 57.5033 40.8454Z"
          fill="#4E92FF"
        />
        <path
          d="M31.2699 46.5114C31.7565 47.0014 32.3968 47.2448 33.0368 47.2448V47.2482C33.6768 47.2482 34.3167 47.0015 34.8034 46.5148C35.7801 45.5381 35.7801 43.9549 34.8034 42.9782C32.5667 40.7415 31.7367 38.8015 31.7367 35.8249C31.7367 31.0282 35.8534 26.9181 40.7334 26.8447C41.8867 26.8481 45.7668 27.1481 48.4102 30.8081C49.2168 31.9281 50.7801 32.1814 51.9001 31.3714C53.0201 30.5648 53.2699 29.0015 52.4632 27.8815C49.7332 24.1015 45.3435 21.8447 40.7168 21.8447H40.6833C32.9933 21.9481 26.7367 28.2182 26.7367 35.8249C26.7367 40.1382 28.0932 43.3347 31.2699 46.5114Z"
          fill="#4E92FF"
        />
      </Box>
      <Box sx={{ textAlign: 'center' }}>
        <Typography variant="h3">We&apos;re almost done!</Typography>
        <Typography variant="caption" color="#A9B2BC">
          Click on start generation button to start building your awesome website, or click on back
          button to do some changes
        </Typography>
      </Box>
      <Box>
        <BaseButton sx={{ mr: 1 }} onClick={onBackClicked} variant="outlined" color="primary">
          Back
        </BaseButton>
        <BaseButton onClick={onStartGenerateClicked} variant="contained" color="primary">
          Start generation
        </BaseButton>
      </Box>
    </>
  );

  const renderLeftImage = (
    <Box
      component="svg"
      width="201px"
      height="207px"
      viewBox="0 0 201 207"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      sx={{
        position: 'absolute',
        left: 0,
        bottom: 0,
        opacity: 0.2,
      }}
    >
      <path
        opacity="0.4"
        d="M-58.2537 171.846C-51.333 146.021 -24.7877 119.476 1.03694 112.555L162.039 69.4079C187.864 62.4872 203.189 77.8118 196.268 103.636L153.121 264.639C146.2 290.463 119.655 317.009 93.8302 323.929L-67.1722 367.076C-92.9968 373.997 -108.321 358.673 -101.401 332.848L-58.2537 171.846Z"
        fill="#4E92FF"
      />
      <path
        d="M-122.793 107.299C-115.872 81.4741 -89.3267 54.9287 -63.5021 48.008L97.5004 4.86103C123.325 -2.05969 138.65 13.2649 131.729 39.0895L88.582 200.092C81.6612 225.917 55.1159 252.462 29.2913 259.383L-131.711 302.53C-157.536 309.45 -172.861 294.126 -165.94 268.301L-122.793 107.299Z"
        fill="#4E92FF"
      />
    </Box>
  );

  const renderRightImage = (
    <Box
      component="svg"
      width="201px"
      height="207px"
      viewBox="0 0 201 207"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      sx={{
        position: 'absolute',
        right: 0,
        bottom: 0,
        opacity: 0.2,
      }}
    >
      <path
        opacity="0.4"
        d="M258.586 171.846C251.665 146.021 225.12 119.476 199.295 112.555L38.2927 69.4079C12.4681 62.4872 -2.85655 77.8118 4.06418 103.636L47.2112 264.639C54.1319 290.463 80.6772 317.009 106.502 323.929L267.504 367.076C293.329 373.997 308.653 358.673 301.733 332.848L258.586 171.846Z"
        fill="#4E92FF"
      />
      <path
        d="M323.125 107.299C316.204 81.4741 289.659 54.9287 263.834 48.008L102.832 4.86103C77.007 -2.05969 61.6823 13.2649 68.6031 39.0895L111.75 200.092C118.671 225.917 145.216 252.462 171.041 259.383L332.043 302.53C357.868 309.45 373.193 294.126 366.272 268.301L323.125 107.299Z"
        fill="#4E92FF"
      />
    </Box>
  );

  return (
    <Box sx={{ width: 1, height: 1 }}>
      {renderLeftImage}
      {renderRightImage}
      <Stack
        spacing={2}
        alignItems="center"
        justifyContent="center"
        sx={{ pt: 8, minHeight: '400px' }}
      >
        {loading ? renderLoading : renderWeAreAlmostDone}
      </Stack>
    </Box>
  );
}
